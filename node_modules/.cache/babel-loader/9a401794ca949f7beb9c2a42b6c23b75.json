{"ast":null,"code":"import _regeneratorRuntime from \"/home/marjaan/sandBox/projects/marketo-pwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/marjaan/sandBox/projects/marketo-pwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/home/marjaan/sandBox/projects/marketo-pwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/marjaan/sandBox/projects/marketo-pwa/src/components/Auth/VerifyPhoneNumber/index.jsx\";\nimport React, { useEffect, useState } from 'react';\nimport OtpInput from 'react-otp-input';\nimport axiosAuth from '../../../config/axiosAuth';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useHistory } from 'react-router-dom';\nimport SubmitButton from '../../../mainComponents/SubmitButton/SubmitButton';\nimport { makeStyles } from '@material-ui/core';\nvar useStyles = makeStyles({\n  root: {\n    display: 'flex',\n    justifyContent: 'center',\n    flexDirection: 'column',\n    alignItems: 'center',\n    direction: 'ltr'\n  },\n  input: {\n    width: '2em !important'\n  }\n});\n\nvar Otp = function Otp(props) {\n  var classes = useStyles();\n\n  var _useState = useState(60),\n      _useState2 = _slicedToArray(_useState, 2),\n      seconds = _useState2[0],\n      setSeconds = _useState2[1];\n\n  var history = useHistory();\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      otpNum = _useState4[0],\n      setOtpNum = _useState4[1];\n\n  var dispatch = useDispatch();\n\n  var _useState5 = useState('ثبت'),\n      _useState6 = _slicedToArray(_useState5, 2),\n      text = _useState6[0],\n      setText = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      status = _useState8[0],\n      setStatus = _useState8[1];\n\n  var phoneNumber = useSelector(function (state) {\n    return state.phoneNumber;\n  });\n\n  var getToken =\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              axiosAuth.defaults.headers.common[\"clientId\"] = \"75ce206c-e9af-4216-a527-49250dd4ceb5\";\n              axiosAuth.defaults.headers.common[\"clientSecret\"] = \"123\";\n              axiosAuth.defaults.headers.common[\"scope\"] = \"a b c\";\n              delete axiosAuth.defaults.headers.common['user_id'];\n              _context.next = 7;\n              return axiosAuth.get(\"/auth/v1.0/user/login/otp/\".concat(phoneNumber, \"/\").concat(otpNum));\n\n            case 7:\n              response = _context.sent;\n              localStorage.setItem('user-token', response.data.result.data.token);\n              dispatch({\n                token: response.data.result.data.token,\n                type: 'SET_TOKEN'\n              });\n              history.push('/shoppingcard');\n              _context.next = 16;\n              break;\n\n            case 13:\n              _context.prev = 13;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0);\n\n            case 16:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 13]]);\n    }));\n\n    return function getToken() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var getCode =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              delete axiosAuth.defaults.headers.common['user_id'];\n              _context2.next = 4;\n              return axiosAuth.get(\"/auth/v1.0/otp/\".concat(phoneNumber));\n\n            case 4:\n              response = _context2.sent;\n              setCounterTime();\n              _context2.next = 10;\n              break;\n\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](0);\n\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 8]]);\n    }));\n\n    return function getCode() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var setCounterTime = function setCounterTime() {};\n\n  useEffect(function () {\n    var interval = setInterval(function () {\n      setSeconds(seconds - 1);\n\n      if (seconds === 0) {\n        clearInterval(interval); // props.changeStatus(false)\n\n        setSeconds(60);\n        setText('ارسال مجدد');\n      }\n    }, 1000);\n    return function () {\n      clearInterval(interval);\n    };\n  }, [seconds]);\n  return React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: classes.root,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  }, React.createElement(OtpInput, {\n    value: otpNum,\n    onChange: function onChange(otp) {\n      setOtpNum(otp);\n    },\n    numInputs: 4,\n    separator: React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }, \"-\"),\n    inputStyle: classes.input,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  })), React.createElement(SubmitButton, {\n    text: text,\n    seconds: seconds,\n    clickHandle: function clickHandle() {\n      getToken();\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }));\n};\n\nexport default Otp;","map":{"version":3,"sources":["/home/marjaan/sandBox/projects/marketo-pwa/src/components/Auth/VerifyPhoneNumber/index.jsx"],"names":["React","useEffect","useState","OtpInput","axiosAuth","useDispatch","useSelector","useHistory","SubmitButton","makeStyles","useStyles","root","display","justifyContent","flexDirection","alignItems","direction","input","width","Otp","props","classes","seconds","setSeconds","history","otpNum","setOtpNum","dispatch","text","setText","status","setStatus","phoneNumber","state","getToken","defaults","headers","common","get","response","localStorage","setItem","data","result","token","type","push","console","log","getCode","setCounterTime","interval","setInterval","clearInterval","otp"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport OtpInput from 'react-otp-input';\nimport axiosAuth from '../../../config/axiosAuth';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useHistory } from 'react-router-dom';\nimport SubmitButton from '../../../mainComponents/SubmitButton/SubmitButton';\nimport { makeStyles } from '@material-ui/core';\nconst useStyles = makeStyles({\n    root: {\n        display: 'flex',\n        justifyContent: 'center',\n        flexDirection: 'column',\n        alignItems: 'center',\n        direction: 'ltr'\n    },\n    input: {\n        width: '2em !important'\n    }\n});\nconst Otp = (props) => {\n    const classes = useStyles();\n    const [seconds, setSeconds] = useState(60);\n    const history = useHistory()\n    const [otpNum, setOtpNum] = useState('');\n    const dispatch = useDispatch();\n    const [text, setText] = useState('ثبت')\n    const [status, setStatus] = useState(false)\n    const phoneNumber = useSelector(state => state.phoneNumber);\n\n    const getToken = async () => {\n        try {\n        axiosAuth.defaults.headers.common[\"clientId\"] = \"75ce206c-e9af-4216-a527-49250dd4ceb5\";\n        axiosAuth.defaults.headers.common[\"clientSecret\"] = \"123\";\n        axiosAuth.defaults.headers.common[\"scope\"] = \"a b c\";            \n        delete axiosAuth.defaults.headers.common['user_id']\n\n\n        const response = await axiosAuth.get(`/auth/v1.0/user/login/otp/${phoneNumber}/${otpNum}`);\n          \n        localStorage.setItem('user-token', response.data.result.data.token);\n         \n        dispatch({token: response.data.result.data.token, type: 'SET_TOKEN'});\n        history.push('/shoppingcard');\n        } catch (error) {\n            console.log(error)\n             \n        }\n    }\n    const getCode = async () => {\n         \n        try {\n            delete axiosAuth.defaults.headers.common['user_id']\n\n            const response = await axiosAuth.get(`/auth/v1.0/otp/${phoneNumber}`);\n            setCounterTime();\n         \n        } catch (error) {\n            \n        }\n    }\n\n    const setCounterTime = () => {\n        \n    }\n    useEffect(() => {\n        const interval = setInterval(() => {\n            setSeconds(seconds-1);\n            if(seconds === 0) {\n                clearInterval(interval)\n                // props.changeStatus(false)\n                setSeconds(60)\n                setText('ارسال مجدد')\n            }\n        },1000);\n        \n        return() => {\n            clearInterval(interval);\n        }\n    },[seconds]);\n\n    return(\n        <React.Fragment>\n            <div className = {classes.root}>\n            <OtpInput \n            value={otpNum}\n            onChange={otp => {\n                setOtpNum(otp)\n            }}\n            numInputs={4}\n            separator={<span>-</span>}\n            inputStyle={classes.input}\n        />\n        \n            </div>\n        <SubmitButton text={text} seconds={seconds} clickHandle={ () => {getToken()}}/>\n        </React.Fragment>\n    )\n}\nexport default Otp;"]},"metadata":{},"sourceType":"module"}